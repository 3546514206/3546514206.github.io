<!DOCTYPE html>


<html lang="zh-CN">


<head>
    <meta charset="utf-8"/>
    
    
    
    <meta
            name="viewport"
            content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>
        
        </title>
  <meta name="generator" content="hexo-theme-ayer">
    
        <link rel="shortcut icon" href="/images/SETSUNAYANG.JPG"/>
    
    
<link rel="stylesheet" href="/dist/main.css">

    
<link rel="stylesheet" href="/css/fonts/remixicon.css">

    
<link rel="stylesheet" href="/css/custom.css">

    
        <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
    
    
 

    <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

    <!-- mermaid -->
    
    <style>
        .swal2-styled.swal2-confirm {
            font-size: 1.6rem;
        }
    </style>
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /><script src="/assets/js/DPlayer.min.js"></script></head>
</html>
</html>


<body>
<div id="app">
    
    
    <main class="content on">
        
    <section class="cover">
        
        <div class="cover-frame">
            <div class="bg-box">
                <img src="/images/pintan-compression.jpg" alt="image frame"/>
            </div>
            <div class="cover-inner text-center text-white">
                <h1><a href="/"></a></h1>
                <div id="subtitle-box">
                    
                        <span id="subtitle"></span>
                    
                </div>
                <div>
                    
                </div>
            </div>
        </div>
        <div class="cover-learn-more">
            <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
        </div>
    </section>



    <script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

    <script>
        try {
            var typed = new Typed("#subtitle", {
                strings: ['我叫杨海波，是一名软件工程师。', '我搭过机房和云基础设施，写过框架，做过千万级MAU的应用系统，具备自下而上的全栈开发经验。', '我将软件工程作为安身立命之本，具备正规、大气的专业素养，并致力于成为软件工程行业的技术专家。'],
                startDelay: 3,
                typeSpeed: 88,
                loop: true,
                backSpeed: 100,
                showCursor: true
            });
        } catch (err) {
            console.log(err)
        }
    </script>

<div id="main">
    <section class="outer">
    
    
        

    <div class="notice" style="margin-top:50px">
        <i class="ri-heart-fill"></i>
        <div class="notice-content" id="broad"></div>
    </div>
    <script type="text/javascript">
        fetch('https://v1.hitokoto.cn')
            .then(response => response.json())
            .then(data => {
                document.getElementById("broad").innerHTML = data.hitokoto;
            })
            .catch(console.error)
    </script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
    
    <article class="articles">
        
        
        
            
                <article
        id="post-RPC、dubbo和网络通讯"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/03/14/RPC%E3%80%81dubbo%E5%92%8C%E7%BD%91%E7%BB%9C%E9%80%9A%E8%AE%AF/"
        >RPC、Dubbo 和网络通讯</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/03/14/RPC%E3%80%81dubbo%E5%92%8C%E7%BD%91%E7%BB%9C%E9%80%9A%E8%AE%AF/" class="article-date">
    <time datetime="2025-03-14T11:41:54.000Z" itemprop="datePublished">2025-03-14</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <p>     之前给同事解释 RPC，由于紧张，语言没有组织好，解释得很乱，现在重新组织一下语言之后书面化记录下来。</p>
<p>     RPC 的全称是远程过程调用（Remote Produce Call），本质上应该将其看作是一种编程范式，这种编程范式，规定了这样的一件事情：RPC 方案应该能够让我们像调用本地方法一样，去调用远程的一个函数，它可以帮助开发人员屏蔽底层的通讯细节，从而专注于业务开发。RPC 是分布式应用系统的核心解决方案之一。</p>
<p><img src="/pic/%E5%B7%A5%E7%A8%8B/RPC%E3%80%81dubbo%E5%92%8C%E7%BD%91%E7%BB%9C%E9%80%9A%E8%AE%AF/RPC.png" alt="RPC"></p>
<p>     RPC 描述的是这样的一种，在分布式场景下的编程范式，实际上和网络协议是没有强关联的关系——既不是对立或并列，也不是包含与被包含的关系。分布式应用开发必然牵涉到多台机器之间的通讯，RPC 客户端调用远程过程，也必须基于某种网络通讯协议，因此才和网络协议扯上关系。</p>
<p>     可是为什么有了 http 之类的应用层通讯协议，RPC 框架往往还会自己去实现一套通讯协议，例如 Dubbo 默认实现的 dubbo 通讯协议，Sofa RPC 实现的 bolt 通讯协议。这是因为 http 通讯是无状态的，这意味着 http 通讯的参与方之间是短连接的，每次通讯都需要重新握手与挥手，这在性能上是一种很大的损失。RPC 框架基于 TCP 协议重新设计的通讯协议，能够定制更加精简的报文结构和更加简单的通信次序，往往还会被设计成长连接的，因此具有更高的性能。但是大多数的 RPC 框架其实都支持多种通讯协议，例如 Sofa RPC 除了支持内置的 bolt 协议，还支持 http、hession2 等。</p>
<p>     我们在理解 Dubbo 的时候，不能只将其简单理解为一个 RPC 通讯框架——通过为应用层动态生成 RPC 的网络通讯代理，使网络通讯细节对业务开发人员透明化，这仅仅只是 dubbo 的数据面作为一款通讯工具最基本的功能而已，在过去几年，Dubbo 早就发展成一个完善的微服务开发框架，拥有完善的服务治理能力。</p>
<p><img src="/pic/%E5%B7%A5%E7%A8%8B/RPC%E3%80%81dubbo%E5%92%8C%E7%BD%91%E7%BB%9C%E9%80%9A%E8%AE%AF/dubbo.png" alt="RPC"></p>
<p>     给同事解释 RPC 的背景是如下图 mPaaS 中，手机客户端与移动网关之间的 RPC 通讯方式（图中的步骤 7）：</p>
<p><img src="/pic/%E5%B7%A5%E7%A8%8B/RPC%E3%80%81dubbo%E5%92%8C%E7%BD%91%E7%BB%9C%E9%80%9A%E8%AE%AF/mpaas.jpg" alt="RPC"></p>
<p>     我问了蚂蚁负责 mPaaS 的开发同学，对方提醒我网关后管生成并向客户端分发的 SDK，实际上就包含了网络通讯代理，只不过这种场景下的 RPC 通讯方式，采用的通讯协议是 http。因此 mPaaS 能够提供“让我们像调用本地方法一样，去调用远程的一个函数”的编程体验，却并不能为了我带来 RPC 框架直接基于 TPC 协议实现的通讯协议的性能提升。</p>

                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dubbo/" rel="tag">dubbo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/" rel="tag">服务治理</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
                <article
        id="post-如何看待Java之父这类人"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/02/25/%E5%A6%82%E4%BD%95%E7%9C%8B%E5%BE%85Java%E4%B9%8B%E7%88%B6%E8%BF%99%E7%B1%BB%E4%BA%BA/"
        >如何看待“Java之父”这类人</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/02/25/%E5%A6%82%E4%BD%95%E7%9C%8B%E5%BE%85Java%E4%B9%8B%E7%88%B6%E8%BF%99%E7%B1%BB%E4%BA%BA/" class="article-date">
    <time datetime="2025-02-25T04:36:41.000Z" itemprop="datePublished">2025-02-25</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <p>     以前有人好奇进了余胜军的学生群（没交费的群，他还有付费学员群），余胜军也在里面。余胜军很少说话，他说过网上冒充他的人很多，知乎那个账号不是他本人。就根据那人在群里对余胜军的观察，觉得这个年轻人至少有脑子，课程水平确实比较初级，也有一些错误，但作为生意人，这个年轻人一点都不差。</p>
<p><img src="/pic/%E5%85%B6%E4%BB%96/Java%E4%B9%8B%E7%88%B6/%E5%B0%8F%E4%B8%91.jpg" alt="Java之父"></p>
<p>     余胜军能为人所熟知，靠的是包装人设，他的人设是家境贫寒，其貌不扬，初中文凭，不喜欢上学也不再上学，早早混社会，然后靠自己努力逆袭。这个人设的前五个短语就是广大中国人的人设，非常接地气。大多数跟他一样出身的中国人，最迷恋的一套成长故事就是，一个看起来屌丝中的屌丝，在学校一无是处，最后混社会混出一片天地。他们的上学经历很失败，他们也对学校充满敌意，他们一点都不敬佩学习好的人，而是疯狂跪舔余胜军这种学习一塌糊涂但在社会上混得有一定成就的人。余胜军正好给他们立了这样一个故事主人公，并且还立住了，所以他们对余胜军才推崇备至。</p>
<p>     至于余胜军那些比较张狂的宣传方式，比如 xx 全网第一，xx 之父之类的，这同样契合他那些粉丝，越是底层出身的人，越是出于自卑而形成的张狂，什么 xx 一哥，xx 一姐，都是这类人给自己网上贴的标签。余胜军这种张狂都是为了迎合他的粉丝，他混这么多年社会，不可能不知道这会找骂。你觉得 java 之父很傻逼，他的粉丝可不觉得，你不是他的受众群体，他只要维护好自己的受众群体就足够了。</p>
<p>     余胜军的课程确实有一些值得商榷的地方，比如课程内容的错误和不规范的地方，但我不认为这是什么特别不能接受的。现在整个社会就已经浮躁急功近利，劣币驱逐良币的现象大范围存在。这些底层人受社会影响，并不想一步一个脚印踏实走出来，这个社会也不给扎扎实实做事的人生存空间，他们想的就是尽快暴富或者生活好起来。余胜军的课程的定位就是给这类人一个机会，本来他的受众群体文化程度就不高，讲一些简单易懂的内容他们也容易上手。课程的错误内容可以通过以后的工作中学习来弥补，当然也许工作单位的技术水平可能还不如余胜军的课呢，我在某些大企业就切实感受到了这一点。</p>
<p>     其实可以拿余胜军和某个拍农村片的网红导演做个对比，俩人其实是一路人，都是靠立底层出身的人设，做一些接地气的事情，通过炒作蹿红。那些网红导演拍的片子纯粹奶头乐，看之前就是傻逼的人看了之后继续傻逼。顺便说一下，那些短视频里拿着玩具枪射这个射那个的老头老太太，每天的演出酬劳一个人几千块，这是我考证过的，你们手机上看到的农村大爷大妈，可能比你厂里的工头都有钱。我觉得余胜军比起那些网红导演，做的事情有积极意义，起码教会了底层人一些技能，让他们有自食其力的可能。</p>

                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%88%90%E9%95%BF/" rel="tag">成长</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
                <article
        id="post-新梦想：梦中情房"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/02/23/%E6%96%B0%E6%A2%A6%E6%83%B3%EF%BC%9A%E6%A2%A6%E4%B8%AD%E6%83%85%E6%88%BF/"
        >新梦想：梦中情房</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/02/23/%E6%96%B0%E6%A2%A6%E6%83%B3%EF%BC%9A%E6%A2%A6%E4%B8%AD%E6%83%85%E6%88%BF/" class="article-date">
    <time datetime="2025-02-23T15:19:25.000Z" itemprop="datePublished">2025-02-23</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <div id="dplayer17" class="dplayer hexo-tag-dplayer-mark" style="margin-bottom: 20px;"></div><script>(function(){var player = new DPlayer({"container":document.getElementById("dplayer17"),"theme":"#FADFA3","loop":true,"lang":"zh-cn","screenshot":true,"hotkey":true,"preload":"auto","volume":0.9,"mutex":true,"video":{"url":"/video/梦中情房/梦中情房.mp4"}});window.dplayers||(window.dplayers=[]);window.dplayers.push(player);})()</script>
                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%94%9F%E6%B4%BB/" rel="tag">生活</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
                <article
        id="post-dubbo3源码分析"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/02/23/dubbo3%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"
        >Apache Dubbo3 源码深入解读</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/02/23/dubbo3%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" class="article-date">
    <time datetime="2025-02-23T13:50:40.000Z" itemprop="datePublished">2025-02-23</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <p><a href="/pdf/dubbo/ApacheDubbo3%E6%BA%90%E7%A0%81%E6%B7%B1%E5%85%A5%E8%A7%A3%E8%AF%BB.pdf">Apache Dubbo3 源码深入解读</a></p>

                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dubbo/" rel="tag">dubbo</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
                <article
        id="post-美团技术年货汇总"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/01/22/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7%E6%B1%87%E6%80%BB/"
        >美团技术年货汇总</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/01/22/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7%E6%B1%87%E6%80%BB/" class="article-date">
    <time datetime="2025-01-22T01:51:18.000Z" itemprop="datePublished">2025-01-22</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2017%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7%EF%BC%88%E5%90%88%E8%BE%91%EF%BC%89.pdf">2017年美团技术年货</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2018%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7-%E5%90%8E%E7%AB%AF.pdf">2018年美团技术年货-后端</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2018%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7-%E6%B5%8B%E8%AF%95.pdf">2018年美团技术年货-测试</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2018%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7-%E7%B3%BB%E7%BB%9F.pdf">2018年美团技术年货-系统</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2018%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7-%E8%BF%90%E7%BB%B4.pdf">2018年美团技术年货-运维</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2019%E5%B9%B4%E7%BE%8E%E5%9B%A2%E7%82%B9%E8%AF%84%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7.pdf">2019年美团技术年货</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2020%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7-%E5%90%88%E9%9B%86.pdf">2020年美团技术年货</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2021%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7.pdf">2021年美团技术年货</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2022%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7-%E5%90%88%E8%BE%91.pdf">2022年美团技术年货</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2023%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7.pdf">2023年美团技术年货</a></p>
<p><a href="/pdf/%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF/2024%E5%B9%B4%E7%BE%8E%E5%9B%A2%E6%8A%80%E6%9C%AF%E5%B9%B4%E8%B4%A7%E5%90%88%E9%9B%86.pdf">2024年美团技术年货</a></p>

                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BA%92%E8%81%94%E7%BD%91/" rel="tag">互联网</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
                <article
        id="post-开发以为的工作和实际的开发工作"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/01/21/%E5%BC%80%E5%8F%91%E4%BB%A5%E4%B8%BA%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%92%8C%E5%AE%9E%E9%99%85%E7%9A%84%E5%BC%80%E5%8F%91%E5%B7%A5%E4%BD%9C/"
        >开发以为的工作和实际的开发工作</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/01/21/%E5%BC%80%E5%8F%91%E4%BB%A5%E4%B8%BA%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%92%8C%E5%AE%9E%E9%99%85%E7%9A%84%E5%BC%80%E5%8F%91%E5%B7%A5%E4%BD%9C/" class="article-date">
    <time datetime="2025-01-21T00:48:40.000Z" itemprop="datePublished">2025-01-21</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <p><img src="/pic/%E5%B7%A5%E4%BD%9C/%E5%BC%80%E5%8F%91%E4%BB%A5%E4%B8%BA%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%92%8C%E5%AE%9E%E9%99%85%E7%9A%84%E5%BC%80%E5%8F%91%E5%B7%A5%E4%BD%9C/%E5%BC%80%E5%8F%91%E4%BB%A5%E4%B8%BA%E7%9A%84%E5%B7%A5%E4%BD%9C%E4%BB%A5%E5%8F%8A%E5%AE%9E%E9%99%85%E7%9A%84%E5%BC%80%E5%8F%91%E5%B7%A5%E4%BD%9C.webp" alt="开发以为的工作以及实际的开发工作"></p>

                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%88%90%E9%95%BF/" rel="tag">成长</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
                <article
        id="post-性能还是一致性"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/01/16/%E6%80%A7%E8%83%BD%E8%BF%98%E6%98%AF%E4%B8%80%E8%87%B4%E6%80%A7/"
        >性能还是一致性？</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/01/16/%E6%80%A7%E8%83%BD%E8%BF%98%E6%98%AF%E4%B8%80%E8%87%B4%E6%80%A7/" class="article-date">
    <time datetime="2025-01-16T07:10:58.000Z" itemprop="datePublished">2025-01-16</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <p>     在握手式国密通讯的机制中，正常逻辑如流程一所示：</p>
<p><img src="/pic/%E5%B7%A5%E7%A8%8B/%E6%80%A7%E8%83%BD%E8%BF%98%E6%98%AF%E4%B8%80%E8%87%B4%E6%80%A7/%E6%B5%81%E7%A8%8B%E4%B8%80.png" alt="流程一"></p>
<p>     上述流程中，服务端来判断 token 是否有效，如果失效会告知客户端，客户端需重新握手协商工作秘钥，并重发请求三。 屹通认为重发是一种性能浪费，于是做了如下流程二的“优化”：</p>
<p><img src="/pic/%E5%B7%A5%E7%A8%8B/%E6%80%A7%E8%83%BD%E8%BF%98%E6%98%AF%E4%B8%80%E8%87%B4%E6%80%A7/%E6%B5%81%E7%A8%8B%E4%BA%8C.png" alt="流程二"></p>
<p>     这里可能存在如下问题：</p>
<p>     <strong>服务端在反馈了握手请求之后重新 ntp 或者客户端手动修改时间导致客户端与服务端的时间戳不一致的问题；</strong></p>
<p>     <strong>服务端意外删除缓存起来的 token 对应的工作秘钥，但是客户端并不知道。</strong></p>
<p>     总结起来，是这么一回事：</p>
<p>     客户端跟服务端通信之前，应该跟服务端协商一些信息，接下来的通信，客户端将依赖于协商的这些信息（实际上就是工作秘钥）进行。但是为了安全性，这些信息是会周期性更换的。正常情况下，应该是客户端走某次与服务器通讯的过程中，由服务端告知客户端这些信息失效了，然后触发重新协商的过程，协商完毕，重新建立上次中断的请求。</p>
<p>     协商的信息中，服务端会返回一些辅助类字段，例如时间戳。然后屹通，根据这个时间戳，在客户端的网络框架去自行计算协商信息的有效期，而不是根据服务端的实际反馈。理由是多了一次业务请求，性能上由浪费。</p>
<p>     重试重发，在各种各样的场景中（例如 JOB 调度，RPC 请求），都是非常常规的做法，并不是非要避免。并且现在，功能都不对了（例如客户端由于网络分区或者用户手动修改手机时间，会导致本地时间戳和服务端时间戳不一致），空谈性能，有什么用。</p>

                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1/" rel="tag">设计</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
                <article
        id="post-全国手机银行排名"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/01/09/%E5%85%A8%E5%9B%BD%E6%89%8B%E6%9C%BA%E9%93%B6%E8%A1%8C%E6%8E%92%E5%90%8D/"
        >2024Q1全国手机银行排名</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/01/09/%E5%85%A8%E5%9B%BD%E6%89%8B%E6%9C%BA%E9%93%B6%E8%A1%8C%E6%8E%92%E5%90%8D/" class="article-date">
    <time datetime="2025-01-09T10:55:18.000Z" itemprop="datePublished">2025-01-09</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <p><img src="/pic/%E5%B7%A5%E4%BD%9C/%E5%85%A8%E5%9B%BD%E6%89%8B%E6%9C%BA%E9%93%B6%E8%A1%8C%E6%8E%92%E5%90%8D/%E5%85%A8%E5%9B%BD%E6%89%8B%E6%9C%BA%E9%93%B6%E8%A1%8C%E6%8E%92%E5%90%8D.png" alt="2024Q1全国手机银行排名"></p>

                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%85%B6%E4%BB%96/" rel="tag">其他</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
                <article
        id="post-2024工作总结"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/01/07/2024%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/"
        >2024工作总结</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/01/07/2024%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/" class="article-date">
    <time datetime="2025-01-07T00:39:05.000Z" itemprop="datePublished">2025-01-07</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <p>     2024 年的工作汇总如下图所示，其中图中下半部分为我的主职——开发平台工作。开发平台今年的工作可以总结为这个方向：应用治理。</p>
<p><img src="/pic/%E5%85%B6%E4%BB%96/2024%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/2024%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93.png" alt="2024工作总结"></p>
<p>     应用治理是相对于服务治理提出来的概念，服务治理是说，PaaS 技术平台围绕 RPC 框架提供的服务注册、服务发现、服务鉴权与限流熔断等。而应用治理，是指在开发平台层提出来的，对应用开发态、运行态、维护台进行全方位质量把关、监控管理的能力。例如下图所示的平台级健康检查与监控能力。</p>
<p><img src="/pic/%E5%85%B6%E4%BB%96/2024%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/%E5%81%A5%E5%BA%B7%E6%A3%80%E6%9F%A5%E4%B8%8E%E7%9B%91%E6%8E%A7.png" alt="健康检查与监控"></p>

                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%85%B6%E4%BB%96/" rel="tag">其他</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
                <article
        id="post-00_从头到尾说一说Java时间日期体系的前世今生"
        class="article article-type-post"
        itemscope
        itemprop="blogPost"
        data-scroll-reveal
>
    <div class="article-inner">
        
            <header class="article-header">
                 
    <h2 itemprop="name">
        <a class="article-title" href="/2025/01/06/00_%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/"
        >从头到尾说一说Java时间日期体系的前世今生</a>
    </h2>
 

                
            </header>
        
        
            <div class="article-meta">
                <a href="/2025/01/06/00_%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/" class="article-date">
    <time datetime="2025-01-06T02:57:37.000Z" itemprop="datePublished">2025-01-06</time>
</a> 
                 
                
            </div>
        
        
        
            <div class="article-entry" itemprop="articleBody">
                 

                 <h4 id="1-突击检查"><strong>1、突击检查</strong></h4>
<p>     如下代码输出什么，机器当下所设定的时区为美国时区，在北京时间 2024-12-07 11:20:51 时，传入字符串“2024-12-07 11:46:36”。最终输出应该是true，还是false呢？</p>
<p><img src="/pic/%E5%9F%BA%E6%9C%AC%E5%8A%9F/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/%E7%AA%81%E5%87%BB%E6%A3%80%E6%9F%A5.webp" alt="突击检查"></p>
<h4 id="2-前言"><strong>2、前言</strong></h4>
<p>     约38亿年前地球出现生命体，约46亿年前太阳系形成，大约138亿年前宇宙大爆炸，那再往前呢？想起吕秀才对姬无命发出灵魂之问『时间是否有开端，宇宙是否有尽头』。施一公曾经在一次演讲中说，宇宙中从来不存在时间，只存在运动。地球公转太阳一圈是一年，这是运动，地球自转一圈是一天，这也是运动。从来就没有时间，或者说时间就是空间。</p>
<p>     『三十年春，秦晋围郑。郑伯使烛之武如秦』两千多年前我们就以时间记事，在造物主已经缔造的这一片井然有序的世界里，我们凭空创建出一个新的概念，并不断尝试融入这个世界体系–沙漏、水钟、日晷等等。今天站在计算机这个领域，也让我们重新梳理一遍，计算机世界里日期时间体系的前世今生。</p>
<h4 id="3-日期从1970-年1月1日说起"><strong>3、日期从1970 年1月1日说起</strong></h4>
<p>     任何一个软件开发人员对这个时间应该都不陌生，有时我们忘记初始化或者忘记赋值时，日期就会显示为1970-01-01，我们也叫日期初始值。那为什么日期的初始值是从1970-01-01开始呢？有一个说法是说遵循了Unix的时间计数，Unix认为 1970年1月1日0点 [1]是时间纪元，那为什么Unix要以这个时间为准呢？</p>
<p>     有一处说法是说，当时操作性系统都是32位，如果每一个数值代表一秒，那么最多可以表示2^32-1，也就是2147483647秒，换算成年大概是68年。而Unix系统就是由Ken Thompson、Dennis Ritchie和Douglas McIlroy等人在贝尔实验室开发于1969年开发的，他们为了让时间尽可能的多利用起来，便用了下一年，即 1970年1月1日作为开始，然后这个约定也逐步延伸到其他各个计算机领域。</p>
<p><img src="/pic/%E5%9F%BA%E6%9C%AC%E5%8A%9F/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/%E6%97%A5%E6%9C%9F%E4%BB%8E1970%E5%B9%B41%E6%9C%881%E6%97%A5%E8%AF%B4%E8%B5%B7.webp" alt="日期从1970 年1月1日说起"></p>
<h4 id="4-时间从gmt与utc说起"><strong>4、时间从GMT与UTC说起</strong></h4>
<p>     聊完日期我们再来看时间，爱好体育的应该都知道，看欧冠得半夜起来看，看NBA得早上起来看，现在是北京时间的14点，同时也是纽约时间的凌晨1点半。那是因为我们各地处不同时区，那时区以什么为初始划分的呢？</p>
<h5 id="4-1-gmt-格林威治时间"><strong>4.1、GMT 格林威治时间</strong></h5>
<p>     GMT的全称是 Greenwich Mean Time [2]即格林威治标准时间，是一种与地球自转相关、以太阳日为单位的时间标准。在十七世纪，格林威治皇家天文台为了海上霸权的扩张计划，选择了穿过英国伦敦格林威治天文台子午仪中心的一条经线作为零度参考线，也就是我们教科书上记载的本初子午线。</p>
<p><img src="/pic/%E5%9F%BA%E6%9C%AC%E5%8A%9F/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/%E6%A0%BC%E6%9E%97%E5%A8%81%E6%B2%BB%E6%97%B6%E9%97%B4.webp" alt="格林威治时间"></p>
<p>     并约定从本初子午线起，经度每向东或者向西间隔15°，就划分一个新的时区[3]，每个时区间隔1小时，在这个区域内，大家使用同样的标准时间。但各个国家也会基于各个国家的情况拆分或合并时区，比如中国横跨5个时区，但我们统一使用东八区；而美国则有东部时间、西部时间、夏威夷时间等等。</p>
<p>     从 1924 年开始，格林威治天文台每小时就会向全世界播报时间，最终截止到 1979 年。至于为什么会终止，自然有它的缺点和局限性，那我们就得聊聊UTC时间了。</p>
<h5 id="4-2-utc-世界协调时间"><strong>4.2、UTC 世界协调时间</strong></h5>
<p>     UTC的全称是 Coordinated Universal Time [4]协调世界时间，也称世界标准时间。据说按英语的简称是CUT，按法语的简称是TUC，然后大家相互拉扯一波后，统一叫了UTC。</p>
<p><img src="/pic/%E5%9F%BA%E6%9C%AC%E5%8A%9F/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/%E5%9C%B0%E7%90%83%E5%85%AC%E8%BD%AC.png" alt="地球公转"></p>
<p>     上述所说GMT时间是以地球自转与围太阳公转来计时的，GMT时间认为地球自转一圈是24<em>3600秒，而地球的运动轨迹受很多方面影响，比如潮汐摩擦、气象变化、地震及地质活动等等，运动的时间周期并不是完全规律和相同的。这样会导致其实一天并不完全是24</em>3600秒，这样平均算下来GMT的一秒就不是完全意义上最精确的一秒。但偏差通常也不会很大，基本为毫秒级偏差，但日积月累如果不加以扶正，就会越差越远。</p>
<p>     而UTC的计数是基于 原子钟（Atomic Clock） [5]的计数，比如铯原子钟采用铯-133原子的特性，在特定能级跃迁时会产生一个非常确定的频率9,192,631,770赫兹。然后基于铯-133原子的运动经过换算确定出我们需要的时间周期，据说这种误差可达每百万年内不到一秒。</p>
<p>     UTC 最终由两部分构成：原子时间与世界时间。原子时间基于原子钟，来标准化我们钟表中每一秒时间前进的数据；世界时间是结合GMT时间，我们用多少个原子时来决定一个地球日的时间长度。从1972年开始，UTC被正式采用为国际标准时间。这年实施了一种新的时间调整机制，包括使用闰秒[6]以便对齐地球自转与原子时间。</p>
<h4 id="5-jdk-时间日期的发展史"><strong>5、JDK 时间日期的发展史</strong></h4>
<h5 id="5-1-java-util-date"><strong>5.1、java.util.Date</strong></h5>
<p>     说起Date那可是JDK的正牌嫡系，从1.0开始就一直存在并延续至今。但只要大家用过一些代码扫描工具，基本都是在提示你尽量不要使用Date。在oracle的官方JDK文档中，有超过一半的函数都是deprecated，要细说Date的问题，那可真是一言难尽。</p>
<p><img src="/pic/%E5%9F%BA%E6%9C%AC%E5%8A%9F/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/java.util.Date.webp" alt="java.util.Date"></p>
<ul>
<li>
<p><strong>不能单独表示日期或时间：</strong> Sat Dec 07 17:36:58 CST 2024 这是我们输出new Date()之后的数据，因为Date本质是某一个时刻的时间戳，导致它不能单独表示日期，更不能表示不带日期的时间。</p>
</li>
<li>
<p><strong>令人捉摸不透的API：</strong> 单就Date的方法名来看，应该是非常友好的。它提供了getYear(), getDay()等等，你但凡用过一次，一定让你抓狂。</p>
</li>
<li>
<p><strong>不支持时区设定：</strong> day和month是从0开始计数的，所以月最大是11，日最大是30，年输出124是因为2024年距离1900年有124年。</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">Date</span> <span class="variable">date</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="comment">// 输出 6</span></span><br><span class="line">    System.out.println(date.getDay());</span><br><span class="line">    <span class="comment">// 输出 11</span></span><br><span class="line">    System.out.println(date.getMonth());</span><br><span class="line">    <span class="comment">// 输出 124</span></span><br><span class="line">    System.out.println(date.getYear());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>不支持时区设定：</strong> 曾经写过一段这样的代码，取当前的中国时间，被老板臭骂一顿。。。Date的本质是一个时间戳。当前此时此刻，全球任何一个地方的时间戳都是同一个，Date本身不支持时区。PS.本质上这行代码也指定不了时区哦~</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Date</span> <span class="variable">now</span> <span class="operator">=</span> Calendar.getInstance(Locale.CHINA).getTime();</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Date是可变的：</strong> Date是一个非常基础底层的类，但它却设计为可变。当我们计算这个data3天后是不是周末，如果程序计算中把这个date加了3天，那么你手上拿着得date也变成了3天后的日期。相比同为底层基础类的String，做得就优秀多了。</li>
</ul>
<h5 id="5-2-难当大任的calendar"><strong>5.2、难当大任的Calendar</strong></h5>
<p>     JDK刚推出就发现了问题，于是赶紧在1.1版本推出了Calendar，尝试用来解决令人诟病的Date，并将Date一众函数都标记为了deprecated。但Calendar依然是可变对象、最多也只能精确到毫秒、线程不安全、API的使用复杂且笨重等等，Calendar整体而言并没有挽回颓势。</p>
<h5 id="5-3-曙光来临之jsr310"><strong>5.3、曙光来临之JSR310</strong></h5>
<p>     在聊JSR310之前，不得不先提一提  Joda-Time [7]这个开源Java库。Joda-Time以清晰的API、良好的时区支持、不可变性、强类型化等特性，得到了开发者社区的广泛好评，并在很多项目中被采用，被视为改善Java日期和时间处理的标杆库。Joda-Time如此优秀，Oracle也开启了收编之旅。2013年Java8发布，其中针对日期时间带来一套全新的标准规约 JSR310 [8]，而JSR310的核心制作者就是Joda-Time的作者Stephen Colebourne。</p>
<p><img src="/pic/%E5%9F%BA%E6%9C%AC%E5%8A%9F/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/JSR310.webp" alt="JSR310"></p>
<ul>
<li><strong>Instant：</strong> Instant这个单词的中文含义是『瞬间』，严格来说Java8之前的Date就应该是现在的Instant。Instant类有维护2个核心字段，当前距离时间纪元的秒数以及秒中的纳秒部分。它指代当前这个时刻，全球任一位置这一时刻都是同一时刻。这一时刻川建国同学在高床软枕打着呼，这一时刻我泡着龙井写着文稿。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The number of seconds from the epoch of 1970-01-01T00:00:00Z.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">long</span> seconds;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The number of nanoseconds, later along the time-line, from the seconds field.</span></span><br><span class="line"><span class="comment"> * This is always positive, and never exceeds 999,999,999.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> nanos;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>LocalDateTime：</strong> LocalDateTime由LocalDate和LocalTime组成，分别日期和时间，以此来解决Date中不能单独表示日期和时间的问题。它们都与时区无关，只客观代表一个无时区的时间，比如2024-12-08 13:46:21，LocalDateTime记录着它的年、月、日、时、分、秒、纳秒。但具体是北京时间的13点还是伦敦时间的13点，由上下文语境自行处理。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/******************** LocalDate ********************/</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The year.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> year;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The month-of-year.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">short</span> month;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The day-of-month.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">short</span> day;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************** LocalTime ********************/</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The hour.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">byte</span> hour;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The minute.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">byte</span> minute;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The second.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">byte</span> second;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The nanosecond.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> nano;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Duration</strong></li>
</ul>
<p>     Duration中文含义译为『期间』，通常用来计算2个时间之前相差的周期，不得不说这一套时间JDK确实定义得语义非常清晰。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Instant</span> <span class="variable">startInstant</span> <span class="operator">=</span> xxx;</span><br><span class="line"><span class="type">Instant</span> <span class="variable">endInstant</span> <span class="operator">=</span> xxx;</span><br><span class="line">Duration.between(startInstant, endInstant).toMinutes();</span><br></pre></td></tr></table></figure>
<p>     这个很好理解，比较2个时间戳时间的相差分钟数。但如果换成LocalDateTime，会是怎样呢？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LocalDateTime</span> <span class="variable">startTime</span> <span class="operator">=</span> xxx;</span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> xxx;</span><br><span class="line">Duration.between(startTime, endTime).toMinutes();</span><br></pre></td></tr></table></figure>
<p>     因为LocalDateTime是不带时区的，所以LocalDateTime是不能直接换成成Instant的。而Duration的比较也是不带时区的，或者你可以理解它是把时间放在同一个时区进行比较，来抹去时区的影响。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/********************* JDK Duration.between 部分源码 *******************************/</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">long</span> <span class="title function_">until</span><span class="params">(Temporal endExclusive, TemporalUnit unit)</span> &#123;</span><br><span class="line">    <span class="type">LocalDateTime</span> <span class="variable">end</span> <span class="operator">=</span> LocalDateTime.from(endExclusive);</span><br><span class="line">    <span class="keyword">if</span> (unit <span class="keyword">instanceof</span> ChronoUnit) &#123;</span><br><span class="line">        <span class="keyword">if</span> (unit.isTimeBased()) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">amount</span> <span class="operator">=</span> date.daysUntil(end.date);</span><br><span class="line">            <span class="keyword">if</span> (amount == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> time.until(end.time, unit);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">long</span> <span class="variable">timePart</span> <span class="operator">=</span> end.time.toNanoOfDay() - time.toNanoOfDay();</span><br><span class="line">            <span class="keyword">if</span> (amount &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                amount--;  <span class="comment">// safe</span></span><br><span class="line">                timePart += NANOS_PER_DAY;  <span class="comment">// safe</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                amount++;  <span class="comment">// safe</span></span><br><span class="line">                timePart -= NANOS_PER_DAY;  <span class="comment">// safe</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">// 余下省略</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>     上述是Duration部分源码，它首先计算出2个时间相差多少天，再比较当天的时间里相差多少纳秒，再进行累加。所以你传过来2024-12-08 和 2024-12-04，那就是相差4天，至于是北京时间的12-08还是伦敦时间的12-04，在Duration里都被抹去了时区的概念。看到这里，上面的编程题里做对了吗？</p>
<ul>
<li><strong>ZonedDateTime</strong></li>
</ul>
<p>     真正需要使用时区，我们就需要用到ZonedDateTime。「zoned」这个单词在英汉词典中是zone的过去分时，译为『划为区域的』。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 输出：2024-12-08T14:18:32.554144+08:00[Asia/Shanghai]</span></span><br><span class="line"><span class="type">ZonedDateTime</span> <span class="variable">defaultZoneTime</span> <span class="operator">=</span> ZonedDateTime.now(); <span class="comment">// 默认时区</span></span><br><span class="line"><span class="comment">// 输出：2024-12-08T01:18:32.560931-05:00[America/New_York]</span></span><br><span class="line"><span class="type">ZonedDateTime</span> <span class="variable">usZoneTime</span> <span class="operator">=</span> ZonedDateTime.now(ZoneId.of(<span class="string">&quot;America/New_York&quot;</span>)); <span class="comment">// 用指定时区获取当前时间</span></span><br></pre></td></tr></table></figure>
<p>     因为LocalDateTime是没有时区的，如果我们需要将LocalDateTime转成ZonedDateTime，就需要带上时区信息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LocalDateTime</span> <span class="variable">localDateTime</span> <span class="operator">=</span> LocalDateTime.of(<span class="number">2024</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">21</span>, <span class="number">17</span>);</span><br><span class="line"><span class="type">ZonedDateTime</span> <span class="variable">zonedDateTime</span> <span class="operator">=</span> localDateTime.atZone(ZoneId.systemDefault());</span><br><span class="line"><span class="type">ZonedDateTime</span> <span class="variable">usZonedDateTime</span> <span class="operator">=</span> localDateTime.atZone(ZoneId.of(<span class="string">&quot;America/New_York&quot;</span>));</span><br></pre></td></tr></table></figure>
<p>     随着JDK不断地发布演进，Time模块确实得到了质的提升，这里不一一细说Java日期时间相关API。如果你还在苦于对Date做各种Utils的花式包装，请拥抱java.time吧。</p>
<h4 id="6-时间日期引起的惨案"><strong>6、时间日期引起的惨案</strong></h4>
<h5 id="6-1-夏令时与冬令时"><strong>6.1、夏令时与冬令时</strong></h5>
<p>     曾经小A做了一个鉴权系统，用于对请求做加密解密，保证每一次都是真实合法有效的接口请求。其中做了一个判定，如果请求的时间距现在已经超过10分钟，就会拒绝该次请求。从逻辑上来说，这很合理，但问题的雪崩却出现在3月的那个晚上。。。</p>
<p><img src="/pic/%E5%9F%BA%E6%9C%AC%E5%8A%9F/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/%E5%A4%8F%E4%BB%A4%E6%97%B6%E4%B8%8E%E5%86%AC%E4%BB%A4%E6%97%B6.webp" alt="夏令时与冬令时"></p>
<ul>
<li><strong>什么是夏令时</strong></li>
</ul>
<p>     夏令时[9]又称夏时制，英文原文为Daylight Saving Time，从名字上可以看出，夏令时诞生的背景是为了更好的利用白天的时间。夏令时概念的提出最早可以追溯到1895年，新西兰昆虫学家乔治·哈德逊向惠灵顿哲学学会提出，提前2小时的日光节约提案，以此在工作结束后，可以获得多出一段的白昼时间。</p>
<p>     具体夏令时的实施，以美国为例，美国会在每年3月的第二个星期日的凌晨2:00，时钟会往前调1个小时变为3:00。再在每年11月的第一个星期日的凌晨2:00，将时钟在往后调1个小时变成1:00，此时的回拨也被称为“冬令时”。</p>
<ul>
<li><strong>夏令时实施的国家与地区</strong></li>
</ul>
<p><img src="/pic/%E5%9F%BA%E6%9C%AC%E5%8A%9F/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/%E4%BB%8E%E5%A4%B4%E5%88%B0%E5%B0%BE%E8%AF%B4%E4%B8%80%E8%AF%B4Java%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E4%BD%93%E7%B3%BB%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F/%E5%A4%8F%E4%BB%A4%E6%97%B6%E5%AE%9E%E6%96%BD%E7%9A%84%E5%9B%BD%E5%AE%B6%E4%B8%8E%E5%9C%B0%E5%8C%BA.webp" alt="夏令时实施的国家与地区"></p>
<blockquote>
<p>蓝色为正在实施夏令时的过去和地区<br>
灰色为曾经实施但现在已经取消夏令时的国家和地区<br>
黑色为从未实施夏令时的过去和地区</p>
</blockquote>
<p>     1916年4月30日，德国与奥匈帝国成为世界上第一组实施夏时制的国家，目的是为了能在战争期间节约煤炭消耗。在1970年代，由于美洲与欧洲地区也受到能源危机影响，至此夏令时开始广泛被实施。当下全球有共约70多个国家和时区在使用夏令时，我国也曾短暂使用过夏令时，但因节约能源效果不显著，以及对日常生活工作等带来的一些影响，到1992年全国宣布取消夏令时。</p>
<h5 id="6-2-闰年与闰秒"><strong>6.2、闰年与闰秒</strong></h5>
<p>     2008年是闰年存在2月29日，但微软一些软件在处理部分任务的时候会因为闰年导致处理错误。微软甚至在SQL Server 2008 CTP发布后曾经宣读了一份证明，建议用户不要在2月29日安装和运行软件，以减少影响。并且在Windows Small Business Server上还会出现更严重的错误：因为在微软的日历里根本没那么一天，因此就无法颁发证书。</p>
<ul>
<li><strong>为什么要闰年</strong></li>
</ul>
<p>     闰年大家比较熟悉，闰年的设置是为了使日历年与太阳年（即地球绕太阳公转一周的时间）更精准地一致。严格来说地球绕太阳一圈的时间，大约是365.2422天。经过大约四年，累计误差将接近一天（0.2422 * 4 ≈ 0.9688天），但如果每4年就加1天，这样每128年又会多算出1天。所以基于此定义出了普通闰年与世纪闰年。</p>
<blockquote>
<p>普通闰年：公历年份是4的倍数，且不是100的倍数的，为闰年（如2004年、2020年等就是闰年）。<br>
世纪闰年：公历年份是整百数的，必须是400的倍数才是闰年（如1900年不是闰年，2000年是闰年）。</p>
</blockquote>
<ul>
<li><strong>为什么要闰秒</strong></li>
</ul>
<p>     闰秒[10]本质上和闰年的作用是一样的，也是解决时间解释运动中所存在的偏差。闰秒的调整是为了确保协调世界时（UTC）与地球自转时间（UT1）[11]保持一致。由于地球自转速度的不均匀性和减慢，UTC需要定期添加或删除一秒钟来进行调整，这一秒钟称为“闰秒”。</p>
<p>     国际地球自转与参考系统服务（IERS）是负责监测和发布闰秒调整的机构。ERS会根据地球自转的实际变化和测量数据，决定是否需要调整闰秒。闰秒通常在6月30日或12月31日的最后一秒添加或删除。这意味着在某些年份，时间序列可能会变为：23:59:59 → 23:59:60 → 00:00:00。</p>
<h4 id="7-写在最后"><strong>7、写在最后</strong></h4>
<p>     『存在不一定合理，但一定有原因』这是曾经我的主管跟我说的，至今我也受益其中。对所有事情怀有一丝怀疑心态，搞懂它的前世今生，或许它不那么合理，但至少当时这样做解决了一定的问题，我们在做新设计的时候可以提前考虑与规避。水多了加面，面多了加水，如果我们只是看到当下的混乱就指着“前人”没有设计思想没有技术匠心，却不了解最初“前人”这样做的意图与背景，骂着“前人”的我们终有一天也会成为后人眼中的“前人”。</p>
<p>     参考链接：<br>
     [1]<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Unix_time">https://en.wikipedia.org/wiki/Unix_time</a><br>
     [2]<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%B8%96%E7%95%8C%E6%97%B6/692237">https://baike.baidu.com/item/世界时/692237</a><br>
     [3]<a target="_blank" rel="noopener" href="https://www.timeanddate.com/time/zones/">https://www.timeanddate.com/time/zones/</a><br>
     [4]<a target="_blank" rel="noopener" href="https://www.utctime.net/">https://www.utctime.net/</a><br>
     [5]<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8E%9F%E5%AD%90%E9%92%9F/765460">https://baike.baidu.com/item/原子钟/765460</a><br>
     [6]<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%97%B0%E7%A7%92">https://baike.baidu.com/item/闰秒</a><br>
     [7]<a target="_blank" rel="noopener" href="https://www.joda.org/joda-time/">https://www.joda.org/joda-time/</a><br>
     [8]<a target="_blank" rel="noopener" href="https://jcp.org/en/jsr/detail">https://jcp.org/en/jsr/detail</a><br>
     [9]<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%A4%8F%E4%BB%A4%E6%97%B6/1809579">https://baike.baidu.com/item/夏令时/1809579</a><br>
     [10]<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%97%B0%E7%A7%92/696742">https://baike.baidu.com/item/闰秒/696742</a><br>
     [11]<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%B8%96%E7%95%8C%E6%97%B6">https://zh.wikipedia.org/wiki/世界时</a></p>

                
                <!-- reward -->
                
            </div>
        

        <!-- copyright -->
        
        <footer class="article-footer">
            
            
    <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li></ul>

        </footer>
    </div>

    
    
    
    
</article>

            
    </article>
    

    
        <nav class="page-nav">
            
            <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/2/">下一页</a>
        </nav>
    
</section>
</div>

        <footer class="footer">
    <div class="outer">
        <ul>
            <li>
                Copyrights &copy;
                2017
                -
                
                2025
                <i class="ri-heart-fill heart_icon"></i> 杨海波
            </li>
        </ul>
        <ul>
            <li>
                
            </li>
        </ul>
        <ul>
            <li>
                
                    
                    <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
                
            </li>
        </ul>
        <ul>
            
        </ul>
        <ul>
            
        </ul>
        <ul>
            <li>
                <!-- cnzz统计 -->
                
            </li>
        </ul>
    </div>
</footer>
    </main>
    <div class="float_btns">
        <div class="totop" id="totop">
    <i class="ri-arrow-up-line"></i>
</div>

    <div class="todark" id="todark">
        <i class="ri-moon-line"></i>
    </div>

    </div>
    <aside class="sidebar on">
        <button class="navbar-toggle"></button>
<nav class="navbar">
    
        <div class="logo">
            <a href="/"><img src="/images/SETSUNAYANG.JPG" alt=""></a>
        </div>
    
    <ul class="nav nav-main">
        
            <li class="nav-item">
                <a class="nav-item-link" href="/">主 页</a>
            </li>
        
            <li class="nav-item">
                <a class="nav-item-link" href="/archives">归 档</a>
            </li>
        
            <li class="nav-item">
                <a class="nav-item-link" href="/tags">标 签</a>
            </li>
        
            <li class="nav-item">
                <a class="nav-item-link" target="_blank" rel="noopener" href="https://github.com/3546514206">Github</a>
            </li>
        
            <li class="nav-item">
                <a class="nav-item-link" target="_blank" rel="noopener" href="http://192.168.31.1/cgi-bin/luci/web">MiRouter</a>
            </li>
        
            <li class="nav-item">
                <a class="nav-item-link" target="_blank" rel="noopener" href="https://javabetter.cn/">进阶之路</a>
            </li>
        
            <li class="nav-item">
                <a class="nav-item-link" target="_blank" rel="noopener" href="https://pdai.tech/">pdai.tech</a>
            </li>
        
            <li class="nav-item">
                <a class="nav-item-link" target="_blank" rel="noopener" href="https://www.mobibrw.com/">友链 一</a>
            </li>
        
            <li class="nav-item">
                <a class="nav-item-link" target="_blank" rel="noopener" href="https://www.wujunhao1024.com/">友链 二</a>
            </li>
        
    </ul>
</nav>
<nav class="navbar navbar-bottom">
    <ul class="nav">
        <li class="nav-item">
            
                <a class="nav-item-link nav-item-search" title="搜索">
                    <i class="ri-search-line"></i>
                </a>
            
            
        </li>
    </ul>
</nav>
<div class="search-form-wrap">
    <div class="local-search local-search-plugin">
    <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
    <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
    <span class="close"><i class="ri-close-line"></i></span>
    <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
    <div class="reward-box">
        
            <div class="reward-item">
                <img class="reward-img" src="/images/alipay.jpg">
                <span class="reward-type">支付宝</span>
            </div>
        
        
            <div class="reward-item">
                <img class="reward-img" src="/images/wechat.jpg">
                <span class="reward-type">微信</span>
            </div>
        
    </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
        rel="stylesheet"
        href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }

    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    });

    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js"></script>
<script src="https://cdn.staticfile.org/mathjax/2.7.7/config/TeX-AMS-MML_HTMLorMML-full.js"></script>
<script>
    var ayerConfig = {
        mathjax: true,
    };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
    function wait(callback, seconds) {
        var timelag = null;
        timelag = window.setTimeout(callback, seconds);
    }

    !function (e, t, a) {
        var initCopyCode = function () {
            var copyHtml = '';
            copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
            copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
            copyHtml += '</button>';
            $(".highlight .code pre").before(copyHtml);
            $(".article pre code").before(copyHtml);
            var clipboard = new ClipboardJS('.btn-copy', {
                target: function (trigger) {
                    return trigger.nextElementSibling;
                }
            });
            clipboard.on('success', function (e) {
                let $btn = $(e.trigger);
                $btn.addClass('copied');
                let $icon = $($btn.find('i'));
                $icon.removeClass('ri-file-copy-2-line');
                $icon.addClass('ri-checkbox-circle-line');
                let $span = $($btn.find('span'));
                $span[0].innerText = 'COPIED';

                wait(function () { // 等待两秒钟后恢复
                    $icon.removeClass('ri-checkbox-circle-line');
                    $icon.addClass('ri-file-copy-2-line');
                    $span[0].innerText = 'COPY';
                }, 2000);
            });
            clipboard.on('error', function (e) {
                e.clearSelection();
                let $btn = $(e.trigger);
                $btn.addClass('copy-failed');
                let $icon = $($btn.find('i'));
                $icon.removeClass('ri-file-copy-2-line');
                $icon.addClass('ri-time-line');
                let $span = $($btn.find('span'));
                $span[0].innerText = 'COPY FAILED';

                wait(function () { // 等待两秒钟后恢复
                    $icon.removeClass('ri-time-line');
                    $icon.addClass('ri-file-copy-2-line');
                    $span[0].innerText = 'COPY';
                }, 2000);
            });
        }
        initCopyCode();
    }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
    if (window.mermaid) {
        mermaid.initialize({theme: "forest"});
    }
</script>


    
    

</div>
</body>

</html>